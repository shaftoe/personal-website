{{- $id := printf "%s/%s" .Section .File.BaseFileName -}}
{{- $sectionData := (index .Site.Data.comments .Section) -}}

{{ with (index $sectionData .File.BaseFileName) }}
<h4>{{ len . }} comment{{ if gt (len .) 1 }}s{{ end }}</h4>
    <ol>
    {{ range . }}
        <li>
            <h5>{{ .name | htmlEscape }}</h5>

            <small class="date">{{ partial "date" .date }}</small>

            <p>{{ .body | markdownify }}</p>
        </li>
    {{- end -}}
    </ol>
{{- end -}}

<h4>Leave a comment</h4>
<form method="POST" action="{{ .Param "staticmanUrl" }}">
    <textarea name="fields[body]" placeholder="New Comment! Feel free to use Markdown." rows="10"></textarea>
    <input type="hidden" name="options[redirect]" value="{{ .Permalink }}#comment-submitted">
    <input type="hidden" name="options[entryId]" value="{{ $id }}">
    <input name="fields[name]" type="text" placeholder="Your name">
    <input name="fields[email]" type="email" placeholder="Your email">
    <input type="submit" value="Submit">
</form>