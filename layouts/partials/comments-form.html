{{- $id := printf "%s/%s" .Section .File.BaseFileName -}}
{{- $sectionData := (index .Site.Data.comments .Section) -}}

{{ with (index $sectionData .File.BaseFileName) }}
<h4>{{ len . }} comment{{ if gt (len .) 1 }}s{{ end }}</h4>
    <ol>
    {{ range . }}
        <li>
            {{ .name | htmlEscape }}: {{ .body | markdownify }} ({{ partial "date" .date }})
        </li>
    {{- end -}}
    </ol>
{{- end -}}

<h4>Leave a comment</h4>
<form method="POST" action="{{ .Param "staticmanUrl" }}">
    <input type="hidden" name="options[redirect]" value="{{ .Permalink }}#comment-submitted">
    <input type="hidden" name="options[entryId]" value="{{ $id }}">
    <input name="fields[name]" type="text" placeholder="Your name">
    <textarea name="fields[body]" placeholder="Your comment. Feel free to use Markdown." rows="10"></textarea>
    <input type="submit" value="Submit">
</form>